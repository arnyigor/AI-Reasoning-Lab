# main.py
import pandas as pd
from CoreGenerator import CorePuzzleGenerator
from EinsteinPuzzle import EinsteinPuzzleDefinition

if __name__ == '__main__':
    # Глобальные настройки для красивого вывода больших таблиц
    pd.set_option('display.max_rows', 500)
    pd.set_option('display.max_columns', 500)
    pd.set_option('display.width', 1000)

    # Общие данные для всех "Загадок Эйнштейна"
    EINSTEIN_THEMES = {
        "Тайна в заброшенной Школе": {
            "Посетитель": ["Учитель Лебедева", "Бывший ученик Роман", "Дворник Михалыч", "Журналистка Нина", "Психолог Олег", "Соседка из деревни", "Студент-паранормальщик", "Бывший директор", "Фотограф с дроном"],
            "Классная комната": ["Кабинет истории", "Лаборатория химии", "Музыкальный зал", "Спортзал с зеркалами", "Актовый зал", "Кабинет литературы", "Подвал с картами", "Библиотека с пропавшими книгами", "Комната для тишины"],
            "Личный предмет": ["Старый дневник в кожаном переплёте", "Разбитые очки", "Магнитофон с кассетой", "Часы, остановившиеся в 3:07", "Кукла с одним глазом", "Гравюра с надписью 'Не забудь'", "Фото с вырванным лицом", "Нож с гравировкой '8 класс'", "Записка 'Они всё ещё здесь'"],
            "Причина визита": ["Искать пропавшего брата", "Вернуть украденное", "Разгадать легенду о подвале", "Снять видео для блога", "Завершить начатое", "Найти школьный архив", "Проверить сон", "Исследовать исчезновения", "Сжечь старые воспоминания"],
            "Особая примета": ["Шрам на ладони", "Говорит только шёпотом", "Не теней после 9 вечера", "Всегда с фонарём", "Носит школьную форму", "Постоянно считает ступеньки", "Пугается скрипа половиц", "Слышит музыку из пустого зала", "Отражение не в зеркале"],
            "Находка в школе": ["Список имён с одной вычеркнутой", "Карта тоннелей под зданием", "Проигранная кассета 'Учительница плачет'", "Доска с уравнением из крови", "Часы в стене, идущие назад", "Письмо будущему себе", "Забытый портфель с дневником", "Ключ от 13-го шкафчика", "Зеркало с трещиной в форме лица"],
            "Время прибытия": ["Ровно в полночь", "За 7 минут до грозы", "В день последнего звонка", "На закате", "Когда часы останавливаются", "После первого удара в дверь", "Во время лунного затмения", "Когда включается свет", "Когда звонит старый звонок"],
            "Связь со школой": ["Был исключён за странный ритуал", "Потерял здесь ребёнка", "Учился в 1987 году", "Пропал на выпускной", "Был влюблён в учителя", "Сдал экзамен, не учившись", "Написал проклятие на стене", "Снилась школа 9 лет подряд", "Забыл, как отсюда вышел"],
            "Сверхъестественное явление": ["Голоса из пустого класса", "Двери, закрывающиеся сами", "Тени на стенах без источника", "Музыка из пианино в зале", "Записи на доске по утрам", "Фотографии, меняющие лица", "Холод в одном углу комнаты", "Эхо, повторяющее будущее", "Предметы, перемещающиеся за спиной"]
        },
        "Загадка в деревне": {
            "Житель": ["Федот", "Марфа", "Домна", "Савва", "Пелагея", "Еремей", "Богдана", "Лукьян"],
            "Профессия": ["Кузнец", "Ткачиха", "Лекарь", "Пасечник", "Гончар", "Садовник", "Мельник", "Смотритель"],
            "Дом": ["Изба с резными ставнями", "Дом у ручья", "Теремок на холме", "Хата с соломенной крышей", "Дом у ветряной мельницы", "Бревенчатый дом с башенкой", "Дом в роще", "Старинная усадьба"],
            "Животное": ["Кот Барсик", "Овчарка Жучка", "Петух Золотогребень", "Коза Звездочка", "Серый кролик", "Ворон Клик", "Утка Кряква", "Осёл Иона"],
            "Растение": ["Яблоня", "Подсолнух", "Шалфей", "Малина", "Тыква", "Рябина", "Лаванда", "Огурец"],
            "Инструмент": ["Коса", "Серп", "Мотыга", "Топор", "Веретено", "Грабли", "Лопата", "Молот"],
            "Напиток": ["Мятный чай", "Квас", "Молоко", "Морс из калины", "Отвар шиповника", "Простокваша", "Яблочный сидр", "Узвар"],
            "Праздник": ["Ивана Купала", "Масленица", "Дожинки", "Коляда", "Семик", "Троица", "Первый звон", "День основания деревни"]
        },
        "Офисная Тайна": {
            "Сотрудник": ["Алина", "Борис", "Виктория", "Глеб", "Дарья", "Евгений", "Жанна", "Илья", "Ксения"],
            "Отдел": ["Маркетинг", "IT-поддержка", "Финансы", "HR", "Логистика", "R&D", "Продажи", "Юридический", "Дизайн"],
            "Рабочее место": ["Стол у окна", "Кабинет 307", "Место у кофемашины", "Тихая зона", "Угловой деск", "Стол с розовыми стикерами", "Место с игрушечным динозавром", "Надпись 'Не беспокоить'", "Стол с фото кота"],
            "Гаджет": ["Ультрабук с наклейками", "Чёрный ноутбук в кожаном чехле", "Двухмониторная станция", "Планшет с ручкой", "Механическая клавиатура", "Серебристый MacBook", "Гибридный ноут-планшет", "Старый ноут с ремонтом", "Цветной Chromebook"],
            "Напиток": ["Чёрный кофе без сахара", "Зелёный чай с лимоном", "Энергетик 'Турбозаряд'", "Какао с зефиром", "Холодный брау", "Латте с корицей", "Мятной чай в кружке-совой", "Газировка 'Офисный вулкан'", "Травяной отвар 'Спокойствие'"],
            "Проект": ["Созвездие", "Омнибус", "Кодекс А", "Проект 'Феникс'", "Система 'Альфа'", "Камертон", "Нейросеть 'Гармония'", "Платформа Q", "Инициатива 'Север'"],
            "Способ передвижения": ["На метро", "На велосипеде", "На электросамокате", "Пешком через парк", "На автобусе №12", "На каршеринге", "На такси", "На электровелосипеде", "На скейте"],
            "Личное увлечение": ["Комнатные растения", "Подкасты о преступлениях", "Кубик Рубика", "Шахматы в обед", "Писать фанфик по сериалу", "Собирать фигурки героев", "Горный велосипед", "Вышивать кроссворд", "Играть в настолки по пятницам"],
            "Секрет": ["Уволился по ошибке", "Пишет роман", "Крадёт скрепки", "Фальшивый диплом", "Спящий шпион", "Влюблён в коллегу", "Саботирует отчёт", "Подменяет кофе", "Забронировал кабинку на год вперёд"]
        },
        "Космическая Одиссея": {
            "Астронавт": ["Капитан Велара", "Доктор Зейн", "Инженер Морок", "Пилот Ним'Ха", "Биолог Сера", "Радист Октав", "Терраформер Лира", "Кибернетик Дрейн", "Разведчик Талон"],
            "Корабль": ["Звёздный Пламень", "Эхо Туманности", "Скользящий Ветер", "Чёрный Клинок", "Орбитальный Страж", "Солярис-9", "Ночной Странник", "Гелиос-Феникс", "Млечный Курьер"],
            "Планета назначения": ["Нексус-7", "Церера Три", "Эгида-IV", "Вальфар", "Зета-Ретрава", "Омикрон Прайм", "Терра Нова", "Ксантия", "Глубокий Покой"],
            "Гравитационный класс": ["Класс M", "Класс X", "Класс G", "Класс D", "Класс O", "Класс T", "Класс E", "Класс Z", "Класс C"],
            "Экипажский жетон": ["Огонь Созвездия", "Сердце Галактики", "Ключ Аркадии", "Символ Омега", "Знак Персея", "Маркер Астреи", "Талисман Вакуума", "Печать Навигатора", "Кристалл Судьбы"],
            "Искусственный интеллект": ["СИНИС", "Оракул-7", "Нейросеть 'Глаз'", "АЕОН", "КИБИС", "Ментор-9", "ВЕЛЬЗЕВУЛ", "ГАЛЛИО", "ТЕСЛА-Ω"],
            "Пищевой рацион": ["Гель №7", "Синт-мясо 'Альфа'", "Кубики энергии", "Желе из водорослей", "Паста 'Выносливость'", "Тюбик 'Космический вкус'", "Сухпайт 'Орбитал'", "Нутри-батончик 'Сверхновая'", "Гидропорридж 'Гелиос'"],
            "Задача миссии": ["Поиск древнего артефакта", "Установка ретранслятора", "Исследование аномалии", "Эвакуация колонистов", "Подавление восстания ИИ", "Терраформирование", "Перехват сигнала 'Голос'", "Доставка вакцины Омега", "Наблюдение за чёрной дырой"],
            "Личный артефакт": ["Фото в рамке", "Антикварные часы", "Кристалл с Земли", "Книга стихов", "Музыкальный модуль", "Оберег из родного мира", "Шахматы в миниатюре", "Записная книжка с кодами", "Медальон с именем"]
        }
    }
    EINSTEIN_STORY_ELEMENTS = {
        "scenario": "",
        "position": "локация"
    }

    # ===============================================================
    # --- НАСТРОЙКИ ГЕНЕРАЦИИ ---
    # ===============================================================

    # --- ГЕНЕРАЦИЯ ЗАДАЧИ №1 (КЛАССИЧЕСКАЯ) ---
    print("\n\n--- ГЕНЕРАЦИЯ ЗАДАЧИ ---")

    # 1. Задаем желаемые параметры
    desired_theme_name = "Офисная Тайна"
    desired_num_items = 4
    desired_num_categories = 4
    is_circular_1 = False

    # 2. Проверяем, что наши желания выполнимы
    target_theme_1 = EINSTEIN_THEMES[desired_theme_name]
    max_possible_items_1 = min(len(v) for v in target_theme_1.values())
    max_possible_categories_1 = len(target_theme_1)

    if desired_num_items > max_possible_items_1:
        raise ValueError(f"Ошибка в Задаче №1: Невозможно создать {desired_num_items} строк, в темах максимум {max_possible_items_1} элементов.")
    if desired_num_categories > max_possible_categories_1:
        raise ValueError(f"Ошибка в Задаче №1: Невозможно создать {desired_num_categories} категорий, в теме '{desired_theme_name}' максимум {max_possible_categories_1}.")

    # 3. Создаем и запускаем генератор
    einstein_def_1 = EinsteinPuzzleDefinition(themes={desired_theme_name: target_theme_1},
                                              story_elements=EINSTEIN_STORY_ELEMENTS,
                                              num_items=desired_num_items,
                                              num_categories=desired_num_categories,
                                              is_circular=is_circular_1)
    core_gen_1 = CorePuzzleGenerator(puzzle_definition=einstein_def_1)
    core_gen_1.generate()
